### https实现原理

1. server返回带有公钥的数字签名后的证书
2. client校验证书，生成随机数，使用公钥加密后返回给server
3. client-server通信采用随机数为密钥的对称加密

### http1.1和http1.0

- 缓存
- 长连接
- host头域
- 流水线发送
- 部分请求

### TCP/IP与UDP是什么关系

- TCP/IP是一个协议簇，它涉及到了链路层、网络层、传输层、应用层，因此包括了UDP

### UDP一对多

- 广播：地址为全1，要指明接收端口号
- 多播：将多台主机分为一组，赋予一个多播地址

### 从输入网址到显示网页的全过程分析

1. DNS解析
2. TCP连接
3. 发送HTTP请求
4. 返回HTTP报文
5. 浏览器解析页面
6. 连接结束

### 进程和线程的区别

- 多个进程之间的地址空间是独立的，多个线程之间的地址空间是共享的
- 进程是操作系统资源分配的基本单位，而线程是任务调度和执行的基本单位
- 进程创建、销毁、切换开销大，线程开销小
- 一个应用程序有一个进程，一个进程至少有一个线程

### 进程和线程中的内容

| 进程     | 线程       |
| -------- | ---------- |
| 地址空间 | 程序计数器 |
| 全局变量 | 寄存器     |
| 打开文件 | 堆栈       |
| 等       | 状态       |



### 死锁的条件

- 互斥：每个资源要么是已被分配给了一个进程，要么是可用的
- 占有和等待：已经得到某个资源的进程可以再请求新的资源
- 不可抢占：已经分配给某个进程的资源，只能被该进程主动释放
- 环路等待：死锁发生时，系统中一定有两个或两个一回事那的进程组成的环路，该环路中的每个进程都在等待着下一个进程占有的资源

### 线程间通信

- 其实就是线程同步
- 锁机制、信号量

### 进程间通信

- 信号量
- 消息队列
- 管道
- socket
- 共享内存

### 类的初始化过程

- 加载、验证、准备、解析、初始化、使用、卸载

### 类加载器

- 双亲委派模型
- 启动类加载器（C++实现）、扩展类加载器、应用程序类加载器
- Tomcat加载机制

## redis的持久化

### 快照

- 采用多进程的COW

### AOF

- AOF日志记录对内存进行修改对的指令记录
- 先校验指令，存入磁盘，执行指令

#### 重写

- 开辟一个子进程对内存进行遍历转换成一系列的redis操作指令，序列化到一个新的AOF日志文件中，序列化完毕后，再将操作期间发生的增量AOF日志追加到新的AOF日志中，追加完后替代旧的日志

#### fsync

- redis对日志文件进行写操作时，实际上是将内容写到了内核缓存中，内核会异步把数据刷新到磁盘
- fsync可以将指定文件的内容强制从内核缓存刷新到磁盘，通常是1秒钟一次

### 混合持久化

- AOF是存储的从持久化开始到持久化结束这段时间发生的增量
- Redis重启的时候，先加载rdb内容，再重放AOF日志

### Mysql如何实现可重复读

- MVCC：同一份数据保留多个版本，根据版本号来读取数据
- 每个事务都有一个递增的id，一个事务更新一条数据，实际上是新增了一条版本号不同的数据进去，每个事务读取数据只读取id小于等于自己的id的数据
- MVCC不能解决幻读

## 红黑树

### 特点

- 根节点为黑色
- 每个结点要么是红的要么是黑的。  
- 不能有连续的红色结点
- 每个叶结点（即Null结点）都是黑色的
- 对于任意结点而言，其到叶结点树尾端NIL指针的每条路径都包含相同数目的黑结点。

### 红黑树和avl

- 红黑树中最长支路的长度必然“不大于”最短者的2倍；AVL左右子树高度差不超过1
- 红黑树查询效率比AVL低，删除效率比AVL高

### B+树

1. 节点的子树数和关键字数相同（B 树是关键字数比子树数少一）
2. 节点的关键字表示的是子树中的最大数，在子树中同样含有这个数据
3. 叶子节点包含了全部数据，同时符合左小右大的顺序
4. 叶子节点上有一条链表连接所有叶子结点

#### 优点

1. 层级更低，IO 次数更少
2. 每次都需要查询到叶子节点，查询性能稳定
3. 叶子节点形成有序链表，范围查询方便
4. 相对于B树，B+树只有叶子结点才有数据，所以在查找的时候一次能读入的路径信息会更多，IO次数更少

#### 缺点

1. 主键不是有序递增的，导致每次插入数据产生大量的数据迁移和空间碎片；
2. 即使主键是有序递增的，大量写请求的分布仍是随机的；

### 为什么String要设计为不可变的

- 从效率优化、安全性、设计考虑思考
- 不可变可以共享字符串常量池中的内容
- 不可变不用担心破坏HashSet的安全性

### 直接赋值字符串和new String

- 直接赋值，String对象指向常量池中的内容
- new String，String对象指向堆，堆中存常量池中地址

### where 中 or 和 and 对于索引的使用有什么区别

- or只有在连接字段全部都有索引的时候才会使用索引

### 为什么重写equals方法后还需要重写HashCode

- 因为有关Map的接口会使用HashCode来计算存储的位置，只重写equals会导致混乱

## hashMap

### 原理

- 6转换为链表，8转换为红黑树；只有链表的长度大于等于8且capacity大于等于`MIN_TREEIFY_CAPACITY`才进行树化，若只满足前者，不满足后者，则扩容；

- ```
      return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
  ```

- 默认的容量为16，冲突因子为0.75；

- 底层用的&不是%

### hashMap和hashTable、ConcurrentHashMap

- HashTable线程安全，已被遗弃
- HashMap键值都允许为null，HashTable和ConcurrentHashMap都不行
- HashTable是对对象加锁，锁住的是整个Map；ConcurrentHashMap是基于局部加锁

### 为什么HashMap线程不安全

- put操作在多线程的时候可能会覆盖数据
- 同时多个resize只有最后一个会有效，甚至造成死循环

### jdk1.7中HashMap死循环

- 循环链表，导致外层的foreach语句永远执行不完

### 为什么采用&不是%以及数组容量为什么是2的指数次幂

- 数组容量为2的指数次幂时，n & (length - 1) == n % length
- 位运算效率更高

### HashSet与HashMap

- HashSet底层采用HashMap来实现，Map的key就是Set中的元素

### ConcurrentHashMap与HashTable

- HashTable是对整个对象都加上锁，效率低

#### jdk1.7

- 通过concurrencyLevel计算出ssize来决定Segment数组容量，Capacity/ssize来得到每个Segment对象对应的HashEntry的数组容量，这两个容量都应该为2的指数次幂，通过移位操作找到最近的2的指数次幂
- Segement类比HashMap，HashEntry类比Entry
- Segement通过继承ReentryLock自带了一 把锁
- 两次hash，第一次定位到Segment，第二次定位到HashEntry

![img](https://user-gold-cdn.xitu.io/2018/3/27/16266cf39566d886?imageslim)

#### jdk1.8

- 采用Node数组+链表+红黑树，相当于是对每个Node都加上了一把锁
- 没有发生hash碰撞的时候采用CAS插入，发生了碰撞则采用Synchronized加锁

![img](https://user-gold-cdn.xitu.io/2018/3/27/16266cf39570edac?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)





### linux进程调度



### 基本类型和包装类

- 对于成员变量，都在堆中分配空间
- 对于局部变量，基本类型在栈中分配空间

### ThreadLocal的内部实现。怎么确定一个线程使用的是哪一个threadlocal？

- 适用于每个线程都有自己的实例，实例希望在多个方法中共享，但不希望被多个线程共享

#### 原理

1. 每个Thread有自己的`ThreadLocal.ThreadLocalMap threadLocals = null;`
2. ThreadLocalMap是一个Entry数组，Entry有一个value属性；Entry继承了WeakReference，通过父类的T成员变量来存储key值，使用get()方法可以得到value对应的ThreadLocal
3. ThreadLocal采用开放定址法来解决hash冲突

#### 内存泄露

![“Threadlocal内存泄露”的图片搜索结果](data:image/jpeg;base64,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)

- 在调用ThreadLocal的get()、set()可能会清除ThreadLocalMap中key为null的Entry对象；
- 主动调用remove方法可以避免内存泄露
- 线程池中最容易发生内存泄露，因为只放回不销毁线程

#### 应用

- 每个线程的不同方法间调用需要传递一个变量（每个线程的变量不一样），使用ThreadLocal就可以避免在每个方法中加上该变量参数，减小了耦合。
- Spring的Dao类是单例的，每个Dao对象需要一个Connection，但是Connection不是单例的；采用ThreadLocal可以使每一个线程拥有一个Connection

#### 注意事项

- 推荐设置为private static；如果不把它设置成static的话，那么每一个线程都会实例化一个ThreadLocal对象，但是实际上每个ThreadLocal对象的作用是一样的，所以重复的对象是浪费；但是ThreadLocal对象用static的话，那么它的生命周期会特别长，这样更容易导致内存泄漏。但是好处是不会重复产生对象
- 为什么对于ThreadLocal的引用要是弱引用，为了及时的回收key

### IOC和AOP

- AOP主要采用了jdk动态代理和cglib

## 算法

### 中文数字转换为阿拉伯数字

- 哈希表存储对应关系

  

### 字符串中第一个不重复字符

- 哈希表法：第一次循环填充Map，第二次循环找第一个value为1的key
- 暴力法：双重循环+flag
- 数组代替Map：一个数组存储出现的次数，第一次for循环计算出每个字符出现次数（asscii码相减得到数组下标），第二次for循环遍历字符数组，找到第一个不重复字符

### 寻找两条链表第一个相交的结点

1. 哈希表法：遍历第一个链表，把结点存入hashMap；遍历第二个链表，判断结点是否已经在hashMap中
2. 栈：遍历两个链表，结点都放入栈中；出栈，第一个不相等的结点的前一个是相交结点
3. 遍历链表记录长度：两个链表都从距离尾结点为n（n为短链表距离尾结点的长度）的结点开始遍历，判断是否相等

### 非递归遍历二叉树

- 中序和前序只需要出一次栈，后续需要出两次栈

### 头条面试反省

- 求数组右边第一个比他大数，在提示之前，用的是常规解法
- 循环依赖思路不对
- 实习时间太短
- 算法较为薄弱

# jd

### 多个线程竞争sychronized(String.class)

### 如何使常量池溢出

### volatile的应用场景

